æˆ‘ä¾†çµ¦ä½ å®Œæ•´çš„ç¨‹å¼ç¢¼,æŒ‰ç…§ä½ çš„å°ˆæ¡ˆçµæ§‹çµ„ç¹”:

## ğŸ“ å®Œæ•´ç¨‹å¼ç¢¼æ¸…å–®

### 1. CODE_GUARD.cs (ä¸»è¦APIé¡åˆ¥)

```csharp
using HI_CODEGUARD_DLL.Factory;
using HI_CODEGUARD_DLL.Models;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL
{
    /// <summary>
    /// æˆæ¬Šç¢¼ç”¢ç”Ÿèˆ‡é©—è­‰ä¸»é¡åˆ¥
    /// </summary>
    public class CODE_GUARD
    {
        /// <summary>
        /// ç”¢ç”Ÿæˆæ¬Šç¢¼
        /// </summary>
        /// <param name="requestJson">JSONæ ¼å¼çš„è«‹æ±‚åƒæ•¸,åŒ…å«SysIDã€Dataã€CodeLength</param>
        /// <returns>JSONæ ¼å¼çš„å›æ‡‰,åŒ…å«Result_codeã€Msgã€Code</returns>
        public string GetCode(string requestJson)
        {
            var response = new MGetCode.GetCodeResponse();

            try
            {
                // ååºåˆ—åŒ–è«‹æ±‚åƒæ•¸
                var request = JsonConvert.DeserializeObject<MGetCode.GetCodeRequest>(requestJson);
                
                if (request == null)
                {
                    response = new MGetCode.GetCodeResponse
                    {
                        Result_code = Common.Codes.PARAMETER_ERROR,
                        Msg = "è«‹æ±‚åƒæ•¸æ ¼å¼éŒ¯èª¤"
                    };
                    return JsonConvert.SerializeObject(response);
                }

                // åŸ·è¡Œç”¢ç”Ÿæˆæ¬Šç¢¼
                FGetCode func = new FGetCode();
                response = func.Execute(request.SysID, request.Data, request.CodeLength);
            }
            catch (JsonException jex)
            {
                response = new MGetCode.GetCodeResponse
                {
                    Result_code = Common.Codes.PARAMETER_ERROR,
                    Msg = "JSONæ ¼å¼éŒ¯èª¤ï¼š" + jex.Message
                };
            }
            catch (Exception ex)
            {
                response = new MGetCode.GetCodeResponse
                {
                    Result_code = Common.Codes.SYSTEM_ERROR,
                    Msg = "ç³»çµ±éŒ¯èª¤ï¼š" + ex.Message
                };
            }

            return JsonConvert.SerializeObject(response);
        }

        /// <summary>
        /// é©—è­‰æˆæ¬Šç¢¼
        /// </summary>
        /// <param name="requestJson">JSONæ ¼å¼çš„è«‹æ±‚åƒæ•¸,åŒ…å«SysIDã€Dataã€CodeLengthã€MaxMinutesã€InputCode</param>
        /// <returns>JSONæ ¼å¼çš„å›æ‡‰,åŒ…å«Result_codeã€Msgã€VerifyResult</returns>
        public string VerifyCode(string requestJson)
        {
            var response = new MVerifyCode.VerifyCodeResponse();

            try
            {
                // ååºåˆ—åŒ–è«‹æ±‚åƒæ•¸
                var request = JsonConvert.DeserializeObject<MVerifyCode.VerifyCodeRequest>(requestJson);
                
                if (request == null)
                {
                    response = new MVerifyCode.VerifyCodeResponse
                    {
                        Result_code = Common.Codes.PARAMETER_ERROR,
                        Msg = "è«‹æ±‚åƒæ•¸æ ¼å¼éŒ¯èª¤",
                        VerifyResult = false
                    };
                    return JsonConvert.SerializeObject(response);
                }

                // åŸ·è¡Œé©—è­‰æˆæ¬Šç¢¼
                FVerifyCode func = new FVerifyCode();
                response = func.Execute(request.SysID, request.Data, request.CodeLength, 
                    request.MaxMinutes, request.InputCode);
            }
            catch (JsonException jex)
            {
                response = new MVerifyCode.VerifyCodeResponse
                {
                    Result_code = Common.Codes.PARAMETER_ERROR,
                    Msg = "JSONæ ¼å¼éŒ¯èª¤ï¼š" + jex.Message,
                    VerifyResult = false
                };
            }
            catch (Exception ex)
            {
                response = new MVerifyCode.VerifyCodeResponse
                {
                    Result_code = Common.Codes.SYSTEM_ERROR,
                    Msg = "ç³»çµ±éŒ¯èª¤ï¼š" + ex.Message,
                    VerifyResult = false
                };
            }

            return JsonConvert.SerializeObject(response);
        }
    }
}
```

-----

### 2. Common.cs (å…±ç”¨å·¥å…·é¡åˆ¥)

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL
{
    public class Common
    {
        /// <summary>
        /// å›æ‡‰ä»£ç¢¼å¸¸æ•¸
        /// </summary>
        public class Codes
        {
            /// <summary>æˆåŠŸ</summary>
            public const string SUCCESS = "0000";
            /// <summary>ç³»çµ±éŒ¯èª¤</summary>
            public const string SYSTEM_ERROR = "9999";
            /// <summary>åƒæ•¸éŒ¯èª¤</summary>
            public const string PARAMETER_ERROR = "1001";
            /// <summary>é©—è­‰å¤±æ•—</summary>
            public const string VERIFY_FAILED = "1002";
        }

        /// <summary>
        /// åå…­é€²ä½å­—ä¸²è½‰Byteé™£åˆ—
        /// </summary>
        public static byte[] HexStringToBytes(string hex)
        {
            if (string.IsNullOrEmpty(hex))
                return new byte[0];

            int length = hex.Length;
            byte[] bytes = new byte[length / 2];
            for (int i = 0; i < length; i += 2)
            {
                bytes[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
            }
            return bytes;
        }

        /// <summary>
        /// æ ¹æ“šç³»çµ±IDå–å¾—é‡‘é‘°(å¯ä¾å¯¦éš›éœ€æ±‚èª¿æ•´)
        /// </summary>
        public static string GetKey(string sysId)
        {
            // é€™è£¡å¯ä»¥æ ¹æ“šä¸åŒç³»çµ±IDè¿”å›ä¸åŒçš„é‡‘é‘°
            // ç›®å‰ä½¿ç”¨ç°¡å–®çš„å°æ‡‰,å¯¦éš›ä¸Šå¯ä»¥å¾è¨­å®šæª”æˆ–åŠ å¯†å„²å­˜è®€å–
            Dictionary<string, string> keyMap = new Dictionary<string, string>
            {
                { "HI_POS", "A1B2C3D4E5F67890" },
                { "HI_WMS", "F1E2D3C4B5A67890" },
                { "HI_APACCESS", "1234567890ABCDEF" }
            };

            if (keyMap.ContainsKey(sysId))
                return keyMap[sysId];

            // é è¨­é‡‘é‘°
            return "0123456789ABCDEF";
        }
    }
}
```

-----

### 3. Models/MGetCode.cs (GetCodeè³‡æ–™æ¨¡å‹)

```csharp
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Models
{
    internal class MGetCode
    {
        /// <summary>
        /// GetCode è«‹æ±‚åƒæ•¸
        /// </summary>
        public class GetCodeRequest
        {
            /// <summary>
            /// ç³»çµ±ID
            /// </summary>
            [JsonProperty]
            [DisplayName("ç³»çµ±ID")]
            public string SysID { get; set; }

            /// <summary>
            /// ç”¢å¯†ç¢¼ä¹‹è³‡æ–™ (ä¾‹å¦‚:åº—ç·¨ã€å“¡ç·¨)
            /// </summary>
            [JsonProperty]
            [DisplayName("ç”¢å¯†ç¢¼ä¹‹è³‡æ–™")]
            public string Data { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼é•·åº¦
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼é•·åº¦")]
            public int CodeLength { get; set; }
        }

        /// <summary>
        /// GetCode å›æ‡‰çµæœ
        /// </summary>
        public class GetCodeResponse
        {
            /// <summary>
            /// å›è¦†ä»£ç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("å›è¦†ä»£ç¢¼")]
            public string Result_code { get; set; }

            /// <summary>
            /// è¨Šæ¯
            /// </summary>
            [JsonProperty]
            [DisplayName("è¨Šæ¯")]
            public string Msg { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼")]
            public string Code { get; set; }
        }
    }
}
```

-----

### 4. Models/MVerifyCode.cs (VerifyCodeè³‡æ–™æ¨¡å‹)

```csharp
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Models
{
    internal class MVerifyCode
    {
        /// <summary>
        /// VerifyCode è«‹æ±‚åƒæ•¸
        /// </summary>
        public class VerifyCodeRequest
        {
            /// <summary>
            /// ç³»çµ±ID
            /// </summary>
            [JsonProperty]
            [DisplayName("ç³»çµ±ID")]
            public string SysID { get; set; }

            /// <summary>
            /// ç”¢å¯†ç¢¼ä¹‹è³‡æ–™ (ä¾‹å¦‚:åº—ç·¨ã€å“¡ç·¨)
            /// </summary>
            [JsonProperty]
            [DisplayName("ç”¢å¯†ç¢¼ä¹‹è³‡æ–™")]
            public string Data { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼é•·åº¦
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼é•·åº¦")]
            public int CodeLength { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼æ™‚æ•ˆ(åˆ†é˜)
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼æ™‚æ•ˆ(åˆ†é˜)")]
            public int MaxMinutes { get; set; }

            /// <summary>
            /// è¼¸å…¥ä¹‹æˆæ¬Šç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("è¼¸å…¥ä¹‹æˆæ¬Šç¢¼")]
            public string InputCode { get; set; }
        }

        /// <summary>
        /// VerifyCode å›æ‡‰çµæœ
        /// </summary>
        public class VerifyCodeResponse
        {
            /// <summary>
            /// å›è¦†ä»£ç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("å›è¦†ä»£ç¢¼")]
            public string Result_code { get; set; }

            /// <summary>
            /// è¨Šæ¯
            /// </summary>
            [JsonProperty]
            [DisplayName("è¨Šæ¯")]
            public string Msg { get; set; }

            /// <summary>
            /// å¯†ç¢¼é©—è­‰çµæœ
            /// </summary>
            [JsonProperty]
            [DisplayName("å¯†ç¢¼é©—è­‰çµæœ")]
            public bool VerifyResult { get; set; }
        }
    }
}
```

-----

### 5. Factory/FGetCode.cs (ç”¢ç”Ÿæˆæ¬Šç¢¼é‚è¼¯)

```csharp
using HI_CODEGUARD_DLL.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Factory
{
    internal class FGetCode
    {
        /// <summary>
        /// åŸ·è¡Œç”¢ç”Ÿæˆæ¬Šç¢¼
        /// </summary>
        public MGetCode.GetCodeResponse Execute(string sysID, string data, int codeLength)
        {
            var response = new MGetCode.GetCodeResponse();

            try
            {
                // åƒæ•¸é©—è­‰
                if (string.IsNullOrWhiteSpace(sysID))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "ç³»çµ±IDä¸å¯ç‚ºç©º";
                    return response;
                }

                if (string.IsNullOrWhiteSpace(data))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "è³‡æ–™ä¸å¯ç‚ºç©º";
                    return response;
                }

                if (codeLength <= 0 || codeLength > 64)
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "æˆæ¬Šç¢¼é•·åº¦å¿…é ˆä»‹æ–¼1-64ä¹‹é–“";
                    return response;
                }

                // ç”¢ç”Ÿæˆæ¬Šç¢¼
                string code = GetCode(sysID, data, codeLength);

                response.Result_code = Common.Codes.SUCCESS;
                response.Msg = "æˆåŠŸ";
                response.Code = code;
            }
            catch (Exception ex)
            {
                response.Result_code = Common.Codes.SYSTEM_ERROR;
                response.Msg = "ç”¢ç”Ÿæˆæ¬Šç¢¼å¤±æ•—ï¼š" + ex.Message;
            }

            return response;
        }

        /// <summary>
        /// è¨ˆç®—æˆæ¬Šç¢¼
        /// </summary>
        private string GetCode(string sysId, string data, int codeLength)
        {
            DateTime tryTime = DateTime.Now;
            // æ™‚é–“ç²¾ç¢ºåˆ°åˆ†é˜,ç§’æ•¸è¨­ç‚º0
            tryTime = new DateTime(tryTime.Year, tryTime.Month, tryTime.Day,
                   tryTime.Hour, tryTime.Minute, 0);
            string timeStr = tryTime.ToString("yyyy-MM-dd HH:mm:ss");

            // çµ„åˆåŸå§‹å­—ä¸²: ç³»çµ±ID + è³‡æ–™ + æ™‚é–“
            string rawString = sysId + data + timeStr;

            byte[] inputBytes = Encoding.UTF8.GetBytes(rawString);

            // SHA256 é›œæ¹Šè™•ç†
            using (SHA256 sha256 = SHA256.Create())
            {
                byte[] hashBytes = sha256.ComputeHash(inputBytes);
                StringBuilder hex = new StringBuilder();
                foreach (byte b in hashBytes)
                {
                    hex.AppendFormat("{0:X2}", b);
                }

                // å–å‰Nç¢¼ä½œç‚ºæˆæ¬Šç¢¼
                string fullHash = hex.ToString();
                if (codeLength > fullHash.Length)
                    codeLength = fullHash.Length;

                return fullHash.Substring(0, codeLength).ToUpper();
            }
        }
    }
}
```

-----

### 6. Factory/FVerifyCode.cs (é©—è­‰æˆæ¬Šç¢¼é‚è¼¯)

```csharp
using HI_CODEGUARD_DLL.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Factory
{
    internal class FVerifyCode
    {
        /// <summary>
        /// åŸ·è¡Œé©—è­‰æˆæ¬Šç¢¼
        /// </summary>
        public MVerifyCode.VerifyCodeResponse Execute(string sysID, string data, int codeLength, int maxMinutes, string inputCode)
        {
            var response = new MVerifyCode.VerifyCodeResponse();

            try
            {
                // åƒæ•¸é©—è­‰
                if (string.IsNullOrWhiteSpace(sysID))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "ç³»çµ±IDä¸å¯ç‚ºç©º";
                    response.VerifyResult = false;
                    return response;
                }

                if (string.IsNullOrWhiteSpace(data))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "è³‡æ–™ä¸å¯ç‚ºç©º";
                    response.VerifyResult = false;
                    return response;
                }

                if (string.IsNullOrWhiteSpace(inputCode))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "è¼¸å…¥æˆæ¬Šç¢¼ä¸å¯ç‚ºç©º";
                    response.VerifyResult = false;
                    return response;
                }

                if (codeLength <= 0 || codeLength > 64)
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "æˆæ¬Šç¢¼é•·åº¦å¿…é ˆä»‹æ–¼1-64ä¹‹é–“";
                    response.VerifyResult = false;
                    return response;
                }

                if (maxMinutes < 0)
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "æ™‚æ•ˆåˆ†é˜æ•¸ä¸å¯å°æ–¼0";
                    response.VerifyResult = false;
                    return response;
                }

                // é©—è­‰æˆæ¬Šç¢¼
                bool isValid = VerifyCode(sysID, data, inputCode, codeLength, maxMinutes);

                if (isValid)
                {
                    response.Result_code = Common.Codes.SUCCESS;
                    response.Msg = "æˆåŠŸ";
                    response.VerifyResult = true;
                }
                else
                {
                    response.Result_code = Common.Codes.VERIFY_FAILED;
                    response.Msg = "æˆæ¬Šç¢¼é©—è­‰å¤±æ•—";
                    response.VerifyResult = false;
                }
            }
            catch (Exception ex)
            {
                response.Result_code = Common.Codes.SYSTEM_ERROR;
                response.Msg = "é©—è­‰æˆæ¬Šç¢¼å¤±æ•—ï¼š" + ex.Message;
                response.VerifyResult = false;
            }

            return response;
        }

        /// <summary>
        /// é©—è­‰æˆæ¬Šç¢¼
        /// å¾€å‰å›æ¨maxMinutesåˆ†é˜,æª¢æŸ¥æ¯ä¸€åˆ†é˜ç”¢ç”Ÿçš„æˆæ¬Šç¢¼æ˜¯å¦ç¬¦åˆ
        /// </summary>
        private bool VerifyCode(string sysId, string data, string inputCode, int codeLength, int maxMinutes)
        {
            string codeCandidate = "";
            DateTime now = DateTime.Now;

            // å¾ç¾åœ¨å¾€å‰æ¨ç®—maxMinutesåˆ†é˜
            for (int i = 0; i <= maxMinutes; i++)
            {
                // æ™‚é–“å¾€å‰ i åˆ†é˜
                DateTime tryTime = now.AddMinutes(-i);
                // æ™‚é–“ç²¾ç¢ºåˆ°åˆ†é˜,ç§’æ•¸è¨­ç‚º0
                var fixedTime = new DateTime(tryTime.Year, tryTime.Month, tryTime.Day, 
                    tryTime.Hour, tryTime.Minute, 0);
                string timeStr = fixedTime.ToString("yyyy-MM-dd HH:mm:ss");

                // çµ„åˆåŸå§‹å­—ä¸²
                string rawString = sysId + data + timeStr;
                byte[] inputBytes = Encoding.UTF8.GetBytes(rawString);

                // SHA256 é›œæ¹Šè™•ç†
                using (SHA256 sha256 = SHA256.Create())
                {
                    byte[] hashBytes = sha256.ComputeHash(inputBytes);
                    StringBuilder hex = new StringBuilder();
                    foreach (byte b in hashBytes)
                    {
                        hex.AppendFormat("{0:X2}", b);
                    }

                    // å–å‰Nç¢¼
                    string fullHash = hex.ToString();
                    if (codeLength > fullHash.Length)
                        codeLength = fullHash.Length;

                    codeCandidate = fullHash.Substring(0, codeLength).ToUpper();
                }

                // æ¯”å°æˆæ¬Šç¢¼(ä¸å€åˆ†å¤§å°å¯«)
                if (codeCandidate.Equals(inputCode.ToUpper(), StringComparison.OrdinalIgnoreCase))
                {
                    return true;
                }
            }

            return false;
        }
    }
}
```

-----

### 7. Properties/AssemblyInfo.cs (çµ„ä»¶è³‡è¨Š)

```csharp
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// çµ„ä»¶çš„ä¸€èˆ¬è³‡è¨Šæ˜¯ç”±ä¸‹åˆ—çš„å±¬æ€§é›†æ§åˆ¶ã€‚
// è®Šæ›´é€™äº›å±¬æ€§çš„å€¼å³å¯ä¿®æ”¹çµ„ä»¶çš„ç›¸é—œè³‡è¨Šã€‚
[assembly: AssemblyTitle("HI_CODEGUARD_DLL")]
[assembly: AssemblyDescription("æˆæ¬Šç¢¼ç”¢ç”Ÿèˆ‡é©—è­‰ç³»çµ±")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("HI_CODEGUARD_DLL")]
[assembly: AssemblyCopyright("Copyright Â© 2024")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// å°‡ ComVisible è¨­ç‚º false å¯è®“æ­¤çµ„ä»¶ä¸­çš„é¡å‹å° COM å…ƒä»¶éš±è—ã€‚
// è‹¥å¿…é ˆå¾ COM å­˜å–æ­¤çµ„ä»¶ä¸­çš„é¡å‹,è«‹åœ¨è©²é¡å‹ä¸Šå°‡ ComVisible å±¬æ€§è¨­å®šç‚º trueã€‚
[assembly: ComVisible(false)]

// ä¸‹åˆ— GUID ç‚ºå°ˆæ¡ˆå…¬é–‹ (Expose) è‡³ COM æ™‚æ‰€è¦ä½¿ç”¨çš„ typelib ID
[assembly: Guid("a1b2c3d4-e5f6-4789-a012-3456789abcde")]

// çµ„ä»¶çš„ç‰ˆæœ¬è³‡è¨Šç”±ä¸‹åˆ—å››å€‹å€¼çµ„æˆ:
//
//      ä¸»è¦ç‰ˆæœ¬
//      æ¬¡è¦ç‰ˆæœ¬
//      çµ„å»ºç·¨è™Ÿ
//      ä¿®è¨‚
//
// æ‚¨å¯ä»¥æŒ‡å®šæ‰€æœ‰çš„å€¼,ä¹Ÿå¯ä»¥ä½¿ç”¨ '*' å°‡çµ„å»ºå’Œä¿®è¨‚ç·¨è™Ÿè¨­ç‚ºé è¨­,å¦‚ä¸‹æ‰€ç¤º:
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]
```

-----

### 8. æ¸¬è©¦ç¨‹å¼ (å¯é¸,ç”¨æ–¼æ¸¬è©¦)

```csharp
using System;
using HI_CODEGUARD_DLL;
using Newtonsoft.Json;

namespace TestCodeGuard
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.OutputEncoding = System.Text.Encoding.UTF8;
            Console.WriteLine("========================================");
            Console.WriteLine("HI_CODEGUARD_DLL æˆæ¬Šç¢¼æ¸¬è©¦ç¨‹å¼");
            Console.WriteLine("========================================\n");

            CODE_GUARD codeGuard = new CODE_GUARD();

            // æ¸¬è©¦1: ç”¢ç”Ÿæˆæ¬Šç¢¼
            Console.WriteLine("ã€æ¸¬è©¦1ã€‘ç”¢ç”Ÿæˆæ¬Šç¢¼");
            Console.WriteLine("----------------------------------------");
            
            string getCodeRequest = @"{
                ""SysID"": ""HI_POS"",
                ""Data"": ""3750"",
                ""CodeLength"": 6
            }";
            
            Console.WriteLine("Request: " + getCodeRequest);
            string getCodeResponse = codeGuard.GetCode(getCodeRequest);
            Console.WriteLine("Response: " + getCodeResponse);
            Console.WriteLine();

            // è§£æå–å¾—æˆæ¬Šç¢¼
            dynamic getCodeResult = JsonConvert.DeserializeObject(getCodeResponse);
            string generatedCode = getCodeResult.Code;

            // æ¸¬è©¦2: é©—è­‰æˆæ¬Šç¢¼(æ­£ç¢º)
            Console.WriteLine("ã€æ¸¬è©¦2ã€‘é©—è­‰æˆæ¬Šç¢¼(æ‡‰è©²æˆåŠŸ)");
            Console.WriteLine("----------------------------------------");
            
            string verifyCodeRequest1 = $@"{{
                ""SysID"": ""HI_POS"",
                ""Data"": ""3750"",
                ""CodeLength"": 6,
                ""MaxMinutes"": 5,
                ""InputCode"": ""{generatedCode}""
            }}";
            
            Console.WriteLine("Request: " + verifyCodeRequest1);
            string verifyCodeResponse1 = codeGuard.VerifyCode(verifyCodeRequest1);
            Console.WriteLine("Response: " + verifyCodeResponse1);
            Console.WriteLine();

            // æ¸¬è©¦3: é©—è­‰æˆæ¬Šç¢¼(éŒ¯èª¤)
            Console.WriteLine("ã€æ¸¬è©¦3ã€‘é©—è­‰æˆæ¬Šç¢¼(æ‡‰è©²å¤±æ•—)");
            Console.WriteLine("----------------------------------------");
            
            string verifyCodeRequest2 = @"{
                ""SysID"": ""HI_POS"",
                ""Data"": ""3750"",
                ""CodeLength"": 6,
                ""MaxMinutes"": 5,
                ""InputCode"": ""WRONG1""
            }";
            
            Console.WriteLine("Request: " + verifyCodeRequest2);
            string verifyCodeResponse2 = codeGuard.VerifyCode(verifyCodeRequest2);
            Console.WriteLine("Response: " + verifyCodeResponse2);
            Console.WriteLine();

            Console.WriteLine("========================================");
            Console.WriteLine("æ¸¬è©¦å®Œæˆ! æŒ‰ä»»æ„éµçµæŸ...");
            Console.ReadKey();
        }
    }
}
```

-----

## ğŸ“‹ ä½¿ç”¨ç¯„ä¾‹

### åœ¨ä½ çš„å°ˆæ¡ˆä¸­å‘¼å«:

```csharp
using HI_CODEGUARD_DLL;
using Newtonsoft.Json;

// åˆå§‹åŒ–
CODE_GUARD codeGuard = new CODE_GUARD();

// ===== ç”¢ç”Ÿæˆæ¬Šç¢¼ =====
string getCodeRequest = @"{
    ""SysID"": ""HI_POS"",
    ""Data"": ""3750"",
    ""CodeLength"": 6
}";

string getCodeResponse = codeGuard.GetCode(getCodeRequest);
Console.WriteLine(getCodeResponse);
// è¼¸å‡º: {"Result_code":"0000","Msg":"æˆåŠŸ","Code":"ABC123"}

// è§£æå›æ‡‰
dynamic result = JsonConvert.DeserializeObject(getCodeResponse);
string code = result.Code;  // å–å¾—ç”¢ç”Ÿçš„æˆæ¬Šç¢¼

// ===== é©—è­‰æˆæ¬Šç¢¼ =====
string verifyCodeRequest = $@"{{
    ""SysID"": ""HI_POS"",
    ""Data"": ""3750"",
    ""CodeLength"": 6,
    ""MaxMinutes"": 5,
    ""InputCode"": ""{code}""
}}";

string verifyCodeResponse = codeGuard.VerifyCode(verifyCodeRequest);
Console.WriteLine(verifyCodeResponse);
// è¼¸å‡º: {"Result_code":"0000","Msg":"æˆåŠŸ","VerifyResult":true}

// è§£æé©—è­‰çµæœ
dynamic verifyResult = JsonConvert.DeserializeObject(verifyCodeResponse);
bool isValid = verifyResult.VerifyResult;  // true = é©—è­‰é€šé
```

-----

## âš™ï¸ éœ€è¦çš„NuGetå¥—ä»¶

åœ¨ä½ çš„å°ˆæ¡ˆä¸­å®‰è£:

```
Install-Package Newtonsoft.Json -Version 13.0.3
```

æˆ–åœ¨ `packages.config` åŠ å…¥:

```xml
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Newtonsoft.Json" version="13.0.3" targetFramework="net48" />
</packages>
```

-----

ä»¥ä¸Šå°±æ˜¯å®Œæ•´çš„ç¨‹å¼ç¢¼!ä½ å¯ä»¥ç›´æ¥è¤‡è£½åˆ°ä½ çš„å°ˆæ¡ˆä¸­ä½¿ç”¨ã€‚æ‰€æœ‰æª”æ¡ˆéƒ½å·²ç¶“åŒ…å«å®Œæ•´çš„è¨»è§£èªªæ˜ã€‚â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹