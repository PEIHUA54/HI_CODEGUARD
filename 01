å¥½çš„!æˆ‘é‡æ–°çµ¦ä½ å®Œæ•´ç¨‹å¼ç¢¼,ä¸¦ä¸”**ä¿æŒ Code çš„å‹åˆ¥ç‚º object**!

-----

## ğŸ“ å®Œæ•´ç¨‹å¼ç¢¼æ¸…å–® (æœ€çµ‚ç‰ˆ)

### 1. CODE_GUARD.cs (ä¸»è¦APIé¡åˆ¥)

```csharp
using HI_CODEGUARD_DLL.Factory;
using HI_CODEGUARD_DLL.Models;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL
{
    /// <summary>
    /// æˆæ¬Šç¢¼ç”¢ç”Ÿèˆ‡é©—è­‰ä¸»é¡åˆ¥
    /// </summary>
    public class CODE_GUARD
    {
        /// <summary>
        /// ç”¢ç”Ÿæˆæ¬Šç¢¼
        /// </summary>
        /// <param name="requestJson">JSONæ ¼å¼çš„è«‹æ±‚åƒæ•¸,åŒ…å«SysIDã€Dataã€CodeLength</param>
        /// <returns>JSONæ ¼å¼çš„å›æ‡‰,åŒ…å«Result_codeã€Msgã€Code</returns>
        public string GetCode(string requestJson)
        {
            var response = new MGetCode.GetCodeResponse();

            try
            {
                // ååºåˆ—åŒ–è«‹æ±‚åƒæ•¸
                var request = JsonConvert.DeserializeObject<MGetCode.GetCodeRequest>(requestJson);
                
                if (request == null)
                {
                    response = new MGetCode.GetCodeResponse
                    {
                        Result_code = Common.Codes.PARAMETER_ERROR,
                        Msg = "è«‹æ±‚åƒæ•¸æ ¼å¼éŒ¯èª¤"
                    };
                    return JsonConvert.SerializeObject(response);
                }

                // åŸ·è¡Œç”¢ç”Ÿæˆæ¬Šç¢¼
                FGetCode func = new FGetCode();
                response = func.Execute(request.SysID, request.Data, request.CodeLength);
            }
            catch (JsonException jex)
            {
                response = new MGetCode.GetCodeResponse
                {
                    Result_code = Common.Codes.PARAMETER_ERROR,
                    Msg = "JSONæ ¼å¼éŒ¯èª¤ï¼š" + jex.Message
                };
            }
            catch (Exception ex)
            {
                response = new MGetCode.GetCodeResponse
                {
                    Result_code = Common.Codes.SYSTEM_ERROR,
                    Msg = "ç³»çµ±éŒ¯èª¤ï¼š" + ex.Message
                };
            }

            return JsonConvert.SerializeObject(response);
        }

        /// <summary>
        /// é©—è­‰æˆæ¬Šç¢¼
        /// </summary>
        /// <param name="requestJson">JSONæ ¼å¼çš„è«‹æ±‚åƒæ•¸,åŒ…å«SysIDã€Dataã€CodeLengthã€MaxMinutesã€InputCode</param>
        /// <returns>JSONæ ¼å¼çš„å›æ‡‰,åŒ…å«Result_codeã€Msgã€VerifyResult</returns>
        public string VerifyCode(string requestJson)
        {
            var response = new MVerifyCode.VerifyCodeResponse();

            try
            {
                // ååºåˆ—åŒ–è«‹æ±‚åƒæ•¸
                var request = JsonConvert.DeserializeObject<MVerifyCode.VerifyCodeRequest>(requestJson);
                
                if (request == null)
                {
                    response = new MVerifyCode.VerifyCodeResponse
                    {
                        Result_code = Common.Codes.PARAMETER_ERROR,
                        Msg = "è«‹æ±‚åƒæ•¸æ ¼å¼éŒ¯èª¤",
                        VerifyResult = false
                    };
                    return JsonConvert.SerializeObject(response);
                }

                // åŸ·è¡Œé©—è­‰æˆæ¬Šç¢¼
                FVerifyCode func = new FVerifyCode();
                response = func.Execute(request.SysID, request.Data, request.CodeLength, 
                    request.MaxMinutes, request.InputCode);
            }
            catch (JsonException jex)
            {
                response = new MVerifyCode.VerifyCodeResponse
                {
                    Result_code = Common.Codes.PARAMETER_ERROR,
                    Msg = "JSONæ ¼å¼éŒ¯èª¤ï¼š" + jex.Message,
                    VerifyResult = false
                };
            }
            catch (Exception ex)
            {
                response = new MVerifyCode.VerifyCodeResponse
                {
                    Result_code = Common.Codes.SYSTEM_ERROR,
                    Msg = "ç³»çµ±éŒ¯èª¤ï¼š" + ex.Message,
                    VerifyResult = false
                };
            }

            return JsonConvert.SerializeObject(response);
        }
    }
}
```

-----

### 2. Common.cs (å…±ç”¨å·¥å…·é¡åˆ¥)

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL
{
    public class Common
    {
        /// <summary>
        /// å›æ‡‰ä»£ç¢¼å¸¸æ•¸
        /// </summary>
        public class Codes
        {
            /// <summary>æˆåŠŸ</summary>
            public const string SUCCESS = "0000";
            /// <summary>ç³»çµ±éŒ¯èª¤</summary>
            public const string SYSTEM_ERROR = "9999";
            /// <summary>åƒæ•¸éŒ¯èª¤</summary>
            public const string PARAMETER_ERROR = "1001";
            /// <summary>é©—è­‰å¤±æ•—</summary>
            public const string VERIFY_FAILED = "1002";
        }
    }
}
```

-----

### 3. Models/MGetCode.cs (GetCodeè³‡æ–™æ¨¡å‹) - **Code æ”¹ç‚º object**

```csharp
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Models
{
    internal class MGetCode
    {
        /// <summary>
        /// GetCode è«‹æ±‚åƒæ•¸
        /// </summary>
        public class GetCodeRequest
        {
            /// <summary>
            /// ç³»çµ±ID
            /// </summary>
            [JsonProperty]
            [DisplayName("ç³»çµ±ID")]
            public string SysID { get; set; }

            /// <summary>
            /// ç”¢å¯†ç¢¼ä¹‹è³‡æ–™ (ä¾‹å¦‚:åº—ç·¨ã€å“¡ç·¨)
            /// </summary>
            [JsonProperty]
            [DisplayName("ç”¢å¯†ç¢¼ä¹‹è³‡æ–™")]
            public string Data { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼é•·åº¦
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼é•·åº¦")]
            public int CodeLength { get; set; }
        }

        /// <summary>
        /// GetCode å›æ‡‰çµæœ
        /// </summary>
        public class GetCodeResponse
        {
            /// <summary>
            /// å›è¦†ä»£ç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("å›è¦†ä»£ç¢¼")]
            public string Result_code { get; set; }

            /// <summary>
            /// è¨Šæ¯
            /// </summary>
            [JsonProperty]
            [DisplayName("è¨Šæ¯")]
            public string Msg { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼ (ä½¿ç”¨ object å‹åˆ¥,å¯¦éš›ä¸Šæœƒæ˜¯ string)
            /// </summary>
            [JsonProperty]
            [DisplayName("å›è¦†çµæœ")]
            public object Code { get; set; }
        }
    }
}
```

-----

### 4. Models/MVerifyCode.cs (VerifyCodeè³‡æ–™æ¨¡å‹)

```csharp
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Models
{
    internal class MVerifyCode
    {
        /// <summary>
        /// VerifyCode è«‹æ±‚åƒæ•¸
        /// </summary>
        public class VerifyCodeRequest
        {
            /// <summary>
            /// ç³»çµ±ID
            /// </summary>
            [JsonProperty]
            [DisplayName("ç³»çµ±ID")]
            public string SysID { get; set; }

            /// <summary>
            /// ç”¢å¯†ç¢¼ä¹‹è³‡æ–™ (ä¾‹å¦‚:åº—ç·¨ã€å“¡ç·¨)
            /// </summary>
            [JsonProperty]
            [DisplayName("ç”¢å¯†ç¢¼ä¹‹è³‡æ–™")]
            public string Data { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼é•·åº¦
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼é•·åº¦")]
            public int CodeLength { get; set; }

            /// <summary>
            /// æˆæ¬Šç¢¼æ™‚æ•ˆ(åˆ†é˜)
            /// </summary>
            [JsonProperty]
            [DisplayName("æˆæ¬Šç¢¼æ™‚æ•ˆ(åˆ†é˜)")]
            public int MaxMinutes { get; set; }

            /// <summary>
            /// è¼¸å…¥ä¹‹æˆæ¬Šç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("è¼¸å…¥ä¹‹æˆæ¬Šç¢¼")]
            public string InputCode { get; set; }
        }

        /// <summary>
        /// VerifyCode å›æ‡‰çµæœ
        /// </summary>
        public class VerifyCodeResponse
        {
            /// <summary>
            /// å›è¦†ä»£ç¢¼
            /// </summary>
            [JsonProperty]
            [DisplayName("å›è¦†ä»£ç¢¼")]
            public string Result_code { get; set; }

            /// <summary>
            /// è¨Šæ¯
            /// </summary>
            [JsonProperty]
            [DisplayName("è¨Šæ¯")]
            public string Msg { get; set; }

            /// <summary>
            /// å¯†ç¢¼é©—è­‰çµæœ
            /// </summary>
            [JsonProperty]
            [DisplayName("å¯†ç¢¼é©—è­‰çµæœ")]
            public bool VerifyResult { get; set; }
        }
    }
}
```

-----

### 5. Factory/FGetCode.cs (ç”¢ç”Ÿæˆæ¬Šç¢¼é‚è¼¯)

```csharp
using HI_CODEGUARD_DLL.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Factory
{
    internal class FGetCode
    {
        /// <summary>
        /// åŸ·è¡Œç”¢ç”Ÿæˆæ¬Šç¢¼
        /// </summary>
        public MGetCode.GetCodeResponse Execute(string sysID, string data, int codeLength)
        {
            var response = new MGetCode.GetCodeResponse();

            try
            {
                // åƒæ•¸é©—è­‰
                if (string.IsNullOrWhiteSpace(sysID))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "ç³»çµ±IDä¸å¯ç‚ºç©º";
                    return response;
                }

                if (string.IsNullOrWhiteSpace(data))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "è³‡æ–™ä¸å¯ç‚ºç©º";
                    return response;
                }

                if (codeLength <= 0 || codeLength > 64)
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "æˆæ¬Šç¢¼é•·åº¦å¿…é ˆä»‹æ–¼1-64ä¹‹é–“";
                    return response;
                }

                // ç”¢ç”Ÿæˆæ¬Šç¢¼
                string code = GetCode(sysID, data, codeLength);

                response.Result_code = Common.Codes.SUCCESS;
                response.Msg = "æˆåŠŸ";
                response.Code = code;  // string è³¦å€¼çµ¦ object,æ²’å•é¡Œ
            }
            catch (Exception ex)
            {
                response.Result_code = Common.Codes.SYSTEM_ERROR;
                response.Msg = "ç”¢ç”Ÿæˆæ¬Šç¢¼å¤±æ•—ï¼š" + ex.Message;
            }

            return response;
        }

        /// <summary>
        /// è¨ˆç®—æˆæ¬Šç¢¼
        /// </summary>
        private string GetCode(string sysId, string data, int codeLength)
        {
            DateTime tryTime = DateTime.Now;
            // æ™‚é–“ç²¾ç¢ºåˆ°åˆ†é˜,ç§’æ•¸è¨­ç‚º0
            tryTime = new DateTime(tryTime.Year, tryTime.Month, tryTime.Day,
                   tryTime.Hour, tryTime.Minute, 0);
            string timeStr = tryTime.ToString("yyyy-MM-dd HH:mm:ss");

            // çµ„åˆåŸå§‹å­—ä¸²: ç³»çµ±ID + è³‡æ–™ + æ™‚é–“
            string rawString = sysId + data + timeStr;

            byte[] inputBytes = Encoding.UTF8.GetBytes(rawString);

            // SHA256 é›œæ¹Šè™•ç†
            using (SHA256 sha256 = SHA256.Create())
            {
                byte[] hashBytes = sha256.ComputeHash(inputBytes);
                StringBuilder hex = new StringBuilder();
                foreach (byte b in hashBytes)
                {
                    hex.AppendFormat("{0:X2}", b);
                }

                // å–å‰Nç¢¼ä½œç‚ºæˆæ¬Šç¢¼
                string fullHash = hex.ToString();
                if (codeLength > fullHash.Length)
                    codeLength = fullHash.Length;

                return fullHash.Substring(0, codeLength).ToUpper();
            }
        }
    }
}
```

-----

### 6. Factory/FVerifyCode.cs (é©—è­‰æˆæ¬Šç¢¼é‚è¼¯)

```csharp
using HI_CODEGUARD_DLL.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;

namespace HI_CODEGUARD_DLL.Factory
{
    internal class FVerifyCode
    {
        /// <summary>
        /// åŸ·è¡Œé©—è­‰æˆæ¬Šç¢¼
        /// </summary>
        public MVerifyCode.VerifyCodeResponse Execute(string sysID, string data, int codeLength, int maxMinutes, string inputCode)
        {
            var response = new MVerifyCode.VerifyCodeResponse();

            try
            {
                // åƒæ•¸é©—è­‰
                if (string.IsNullOrWhiteSpace(sysID))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "ç³»çµ±IDä¸å¯ç‚ºç©º";
                    response.VerifyResult = false;
                    return response;
                }

                if (string.IsNullOrWhiteSpace(data))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "è³‡æ–™ä¸å¯ç‚ºç©º";
                    response.VerifyResult = false;
                    return response;
                }

                if (string.IsNullOrWhiteSpace(inputCode))
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "è¼¸å…¥æˆæ¬Šç¢¼ä¸å¯ç‚ºç©º";
                    response.VerifyResult = false;
                    return response;
                }

                if (codeLength <= 0 || codeLength > 64)
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "æˆæ¬Šç¢¼é•·åº¦å¿…é ˆä»‹æ–¼1-64ä¹‹é–“";
                    response.VerifyResult = false;
                    return response;
                }

                if (maxMinutes < 0)
                {
                    response.Result_code = Common.Codes.PARAMETER_ERROR;
                    response.Msg = "æ™‚æ•ˆåˆ†é˜æ•¸ä¸å¯å°æ–¼0";
                    response.VerifyResult = false;
                    return response;
                }

                // é©—è­‰æˆæ¬Šç¢¼
                bool isValid = VerifyCode(sysID, data, inputCode, codeLength, maxMinutes);

                if (isValid)
                {
                    response.Result_code = Common.Codes.SUCCESS;
                    response.Msg = "æˆåŠŸ";
                    response.VerifyResult = true;
                }
                else
                {
                    response.Result_code = Common.Codes.VERIFY_FAILED;
                    response.Msg = "æˆæ¬Šç¢¼é©—è­‰å¤±æ•—";
                    response.VerifyResult = false;
                }
            }
            catch (Exception ex)
            {
                response.Result_code = Common.Codes.SYSTEM_ERROR;
                response.Msg = "é©—è­‰æˆæ¬Šç¢¼å¤±æ•—ï¼š" + ex.Message;
                response.VerifyResult = false;
            }

            return response;
        }

        /// <summary>
        /// é©—è­‰æˆæ¬Šç¢¼
        /// å¾€å‰å›æ¨maxMinutesåˆ†é˜,æª¢æŸ¥æ¯ä¸€åˆ†é˜ç”¢ç”Ÿçš„æˆæ¬Šç¢¼æ˜¯å¦ç¬¦åˆ
        /// </summary>
        private bool VerifyCode(string sysId, string data, string inputCode, int codeLength, int maxMinutes)
        {
            string codeCandidate = "";
            DateTime now = DateTime.Now;

            // å¾ç¾åœ¨å¾€å‰æ¨ç®—maxMinutesåˆ†é˜
            for (int i = 0; i <= maxMinutes; i++)
            {
                // æ™‚é–“å¾€å‰ i åˆ†é˜
                DateTime tryTime = now.AddMinutes(-i);
                // æ™‚é–“ç²¾ç¢ºåˆ°åˆ†é˜,ç§’æ•¸è¨­ç‚º0
                var fixedTime = new DateTime(tryTime.Year, tryTime.Month, tryTime.Day, 
                    tryTime.Hour, tryTime.Minute, 0);
                string timeStr = fixedTime.ToString("yyyy-MM-dd HH:mm:ss");

                // çµ„åˆåŸå§‹å­—ä¸²
                string rawString = sysId + data + timeStr;
                byte[] inputBytes = Encoding.UTF8.GetBytes(rawString);

                // SHA256 é›œæ¹Šè™•ç†
                using (SHA256 sha256 = SHA256.Create())
                {
                    byte[] hashBytes = sha256.ComputeHash(inputBytes);
                    StringBuilder hex = new StringBuilder();
                    foreach (byte b in hashBytes)
                    {
                        hex.AppendFormat("{0:X2}", b);
                    }

                    // å–å‰Nç¢¼
                    string fullHash = hex.ToString();
                    if (codeLength > fullHash.Length)
                        codeLength = fullHash.Length;

                    codeCandidate = fullHash.Substring(0, codeLength).ToUpper();
                }

                // æ¯”å°æˆæ¬Šç¢¼(ä¸å€åˆ†å¤§å°å¯«)
                if (codeCandidate.Equals(inputCode.ToUpper(), StringComparison.OrdinalIgnoreCase))
                {
                    return true;
                }
            }

            return false;
        }
    }
}
```

-----

### 7. Properties/AssemblyInfo.cs (çµ„ä»¶è³‡è¨Š)

```csharp
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// çµ„ä»¶çš„ä¸€èˆ¬è³‡è¨Šæ˜¯ç”±ä¸‹åˆ—çš„å±¬æ€§é›†æ§åˆ¶ã€‚
// è®Šæ›´é€™äº›å±¬æ€§çš„å€¼å³å¯ä¿®æ”¹çµ„ä»¶çš„ç›¸é—œè³‡è¨Šã€‚
[assembly: AssemblyTitle("HI_CODEGUARD_DLL")]
[assembly: AssemblyDescription("æˆæ¬Šç¢¼ç”¢ç”Ÿèˆ‡é©—è­‰ç³»çµ±")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("HI_CODEGUARD_DLL")]
[assembly: AssemblyCopyright("Copyright Â© 2024")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// å°‡ ComVisible è¨­ç‚º false å¯è®“æ­¤çµ„ä»¶ä¸­çš„é¡å‹å° COM å…ƒä»¶éš±è—ã€‚
// è‹¥å¿…é ˆå¾ COM å­˜å–æ­¤çµ„ä»¶ä¸­çš„é¡å‹,è«‹åœ¨è©²é¡å‹ä¸Šå°‡ ComVisible å±¬æ€§è¨­å®šç‚º trueã€‚
[assembly: ComVisible(false)]

// ä¸‹åˆ— GUID ç‚ºå°ˆæ¡ˆå…¬é–‹ (Expose) è‡³ COM æ™‚æ‰€è¦ä½¿ç”¨çš„ typelib ID
[assembly: Guid("a1b2c3d4-e5f6-4789-a012-3456789abcde")]

// çµ„ä»¶çš„ç‰ˆæœ¬è³‡è¨Šç”±ä¸‹åˆ—å››å€‹å€¼çµ„æˆ:
//
//      ä¸»è¦ç‰ˆæœ¬
//      æ¬¡è¦ç‰ˆæœ¬
//      çµ„å»ºç·¨è™Ÿ
//      ä¿®è¨‚
//
// æ‚¨å¯ä»¥æŒ‡å®šæ‰€æœ‰çš„å€¼,ä¹Ÿå¯ä»¥ä½¿ç”¨ '*' å°‡çµ„å»ºå’Œä¿®è¨‚ç·¨è™Ÿè¨­ç‚ºé è¨­,å¦‚ä¸‹æ‰€ç¤º:
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]
```

-----

## ğŸ’¡ é—œæ–¼ Code å‹åˆ¥çš„èªªæ˜

### å•é¡Œ:Code ç”¨ object é‚„æ˜¯ string?

**ç­”æ¡ˆ:å…©ç¨®éƒ½å¯ä»¥!**

#### 1. ä½¿ç”¨ `object` çš„åŸå›  (ä½ ä¸»ç®¡çš„ç‰ˆæœ¬):

```csharp
public object Code { get; set; }
```

**å„ªé»:**

- æ›´æœ‰å½ˆæ€§,æœªä¾†å¯ä»¥å›å‚³ä¸åŒå‹åˆ¥
- ä¾‹å¦‚:å¯èƒ½å›å‚³ stringã€intã€æˆ–è‡ªè¨‚ç‰©ä»¶
- JSON åºåˆ—åŒ–æ™‚æ²’å·®åˆ¥

**ç¼ºé»:**

- ä½¿ç”¨æ™‚éœ€è¦è½‰å‹: `string code = result.Code.ToString();`

#### 2. ä½¿ç”¨ `string` çš„ç‰ˆæœ¬:

```csharp
public string Code { get; set; }
```

**å„ªé»:**

- å‹åˆ¥æ˜ç¢º,ä¸éœ€è¦è½‰å‹
- ä½¿ç”¨æ™‚ç›´æ¥: `string code = result.Code;`

**ç¼ºé»:**

- æ²’æœ‰å½ˆæ€§

-----

### å¯¦éš›ä½¿ç”¨æ¯”è¼ƒ:

#### ä½¿ç”¨ object æ™‚:

```csharp
CODE_GUARD guard = new CODE_GUARD();
string response = guard.GetCode(requestJson);
dynamic result = JsonConvert.DeserializeObject(response);

// éœ€è¦è½‰å‹æˆ–ç”¨ ToString()
string code = result.Code.ToString();  // â† éœ€è¦ ToString()
```

#### ä½¿ç”¨ string æ™‚:

```csharp
CODE_GUARD guard = new CODE_GUARD();
string response = guard.GetCode(requestJson);
dynamic result = JsonConvert.DeserializeObject(response);

// ç›´æ¥ä½¿ç”¨
string code = result.Code;  // â† ç›´æ¥ä½¿ç”¨
```

-----

### JSON è¼¸å‡ºæ²’å·®åˆ¥:

**ä¸ç®¡æ˜¯ object æˆ– string,JSON åºåˆ—åŒ–å¾Œéƒ½ä¸€æ¨£:**

```json
{
  "Result_code": "0000",
  "Msg": "æˆåŠŸ",
  "Code": "ABC123"
}
```

-----

## âœ… æˆ‘çš„å»ºè­°

**ä½¿ç”¨ object (è·Ÿä½ ä¸»ç®¡ä¸€æ¨£)**

åŸå› :

1. ä¿æŒèˆ‡ä¸»ç®¡çš„è¦æ ¼ä¸€è‡´
1. å¯¦éš›ä¸Šæ²’æœ‰å½±éŸ¿
1. ä½¿ç”¨æ™‚ç”¨ `ToString()` æˆ– `dynamic` éƒ½å¾ˆç°¡å–®

-----

## ğŸ“ ä½¿ç”¨ç¯„ä¾‹ (Code ç‚º object æ™‚)

```csharp
using HI_CODEGUARD_DLL;
using Newtonsoft.Json;

CODE_GUARD guard = new CODE_GUARD();

// ===== ç”¢ç”Ÿæˆæ¬Šç¢¼ =====
string request = @"{
    ""SysID"": ""HI_POS"",
    ""Data"": ""3750"",
    ""CodeLength"": 6
}";

string response = guard.GetCode(request);
dynamic result = JsonConvert.DeserializeObject(response);

// æ–¹æ³•1: ç”¨ ToString()
string code1 = result.Code.ToString();

// æ–¹æ³•2: ç›´æ¥è½‰å‹
string code2 = (string)result.Code;

// æ–¹æ³•3: ç”¨ Convert
string code3 = Convert.ToString(result.Code);

Console.WriteLine($"æˆæ¬Šç¢¼: {code1}");
```

-----

ä»¥ä¸Šå°±æ˜¯**å®Œæ•´ä¸”æ­£ç¢º**çš„ç¨‹å¼ç¢¼,Code å·²ç¶“æ”¹ç‚º **object** å‹åˆ¥,è·Ÿä½ ä¸»ç®¡çš„è¦æ ¼ä¸€è‡´! ğŸ‘â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹